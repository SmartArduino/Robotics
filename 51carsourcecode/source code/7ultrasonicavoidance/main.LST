C51 COMPILER V9.01   MAIN                                                                  11/14/2013 12:05:30 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**********************»Û¾»µç×ÓÖÇÄÜĞ¡³µÀı³Ì************************
   2          *  Æ½Ì¨£ºHJ-C51 HJ-1G HL-1 HJ-3G HJ-C52  + Keil uVision4 + STC89C52 + AT89S52
   3          *  Ãû³Æ£ºHL-1ÖÇÄÜĞ¡³µ³¬Éù²¨³ÌĞò
   4          *  ¹«Ë¾£º»Û¾»µç×Ó¿Æ¼¼ÓĞÏŞ¹«Ë¾
   5          *  ÌÔ±¦£ºhttp://shop37031453.taobao.com       
   6          *  ÍøÕ¾£ºwww.hjmcu.com    www.hlmcu.com
   7          *  ±àĞ´£H
   8          *  ÈÕÆÚ£º2008-8-08
   9          *  ĞŞ¸ÄÄÚÈİ£º´«¸ĞÆ÷IO¿Ú·Ö±ğ½Óµ½P3.2 P3.3 ¿Ú£¬Ã¿¸öĞ¡³µµç»ú²Î¿¼¿ÉÄÜ²»Í¬£¬Çë×Ô¼ºµ÷Õû²Î¿¼£¬ÒÔ¸üÎÈ¶¨×ßºÚÏß
  10          *   QQ : 398115088 121350852
  11          *  ¾§Õñ:11.0592MHZ
  12          *  ËµÃ÷£ºÃâ·Ñ¿ªÔ´£¬²»Ìá¹©Ô´´úÂë·ÖÎö£¬ÓĞÎÊÌâÖ±½Óµ½»Û¾»ÂÛÌ³½»Á÷
  13          *  ÂÛÌ³£º
  14          *  Ó²¼şÉèÖÃ£ºÒªÓĞ×Ô¼º¶¯ÊÖÄÜÁ¦£¬²ÅÄÜÍê³ÉÊµÑé
  15          *  Ê¹ÓÃËµÃ÷£º¸ù¾İÏÂÃæIO¿Ú×Ô¼ºÓÃ¶Å°îÏßÁ¬½Ó¸÷ÖÖÄ£¿é£¬¿ÉÒÔ×Ô¼ºĞŞ¸Ä¸÷ÖÖÄ£¿éIO¿Ú
  16          *  ĞèÒª¹ºÂò»Û¾»µç×ÓÖÇÄÜĞ¡³µÏà¹ØÄ£¿é²ÅÄÜ×öÊµÑé--ÇëÖ±½Óµ½»Û¾»ÍøÕ¾¹ºÂò
  17          *  Ñ§Ï°½¨Òé£ºÇëµ½»Û¾»µç×ÓÑ§Ï°ÍøWWW.HJMCU.COMÃâ·ÑÏÂÔØ52¿Î¡¶´ÓÁãµ½ÏîÄ¿¿ª·¢Ñ§51µ¥Æ¬»úÓëCÓïÑÔ¼¼ÊõÊÓÆµ½Ì³Ì¡· BT
             -ÏÂÔØ3.63G
  18             ÖØµãÌáÊ¾£º±¾³ÌĞòÖ»×ö²Î¿¼£¬²»Ìá¹©¼¼ÊõÖ§³Ö£¬Çë×Ô¼ºÑĞ¾¿ÎüÊÕ¡£//ÊÕ»õ5ĞÇºÃÆÀ£¬ºóÃæ¸üÓĞ10G×ÊÁÏÔùËÍ£¬ÍøÉÏÏÂÔØ¡
             -£
  19             *  Í¬Ê±Òª½ÓºÃLCD1602 ×¢Òâµ÷½ÚW1¶Ô±È¶È£¬ÓÃµçÄÔUSB¹©µçÊ±µ÷´óÒ»µã£¬ÓÃµç³Ø¹©µçÊ±µ÷Ğ¡Ò»µã¶Ô±È¶È¡£
  20          
  21             HL-1ÓëHL-1ÖÇÄÜĞ¡³µµÍÅÌ±¾¶Å°îÏß½ÓÏß·½·¨£¬ÇëÒ»¶¨ÕÕ×ö£¬·ñÔò¿ÉÄÜ²»¹¤×÷£¬²¢ÉÕ»ÙĞ¡³µ¡£
  22          
  23             J3
  24             IN1--½Óµ½--ÊµÑé°åÉÏµÄP1.2
  25             IN2--½Óµ½--ÊµÑé°åÉÏµÄP1.3
  26             EN1--½Óµ½--ÊµÑé°åÉÏµÄP1.4
  27             EN2--½Óµ½--ÊµÑé°åÉÏµÄP1.5
  28             IN3--½Óµ½--ÊµÑé°åÉÏµÄP1.6
  29             IN4--½Óµ½--ÊµÑé°åÉÏµÄP1.7
  30             J4 
  31             IN5--½Óµ½--ÊµÑé°åÉÏµÄP2.1
  32             IN6--½Óµ½--ÊµÑé°åÉÏµÄP2.0
  33             J5
  34             OUT1--½Óµ½--ÊµÑé°åÉÏµÄP3.2
  35             OUT2--½Óµ½--ÊµÑé°åÉÏµÄP3.3
  36             OUT3--½Óµ½--ÊµÑé°åÉÏµÄP3.4
  37             OUT4--½Óµ½--ÊµÑé°åÉÏµÄP3.5
  38          
  39             µçÔ´½Ó·¨----Çë×¢ÒâºË¶Ô£¬Ò»¶¨Òª100%ÕıÈ·£¬·ñÔò»áÉÕ»µHL-1ÊµÑé°å
  40             J17
  41             VCC--½Óµ½--ÊµÑé°åÉÏµÄ TTL V Òı½Å
  42             GND--½Óµ½--ÊµÑé°åÉÏµÄ TTL G Òı½Å
  43          ******************************************************************/
  44          //ËµÃ÷£ºÈç¹ûÃ»ÓĞLCD1602Òº¾§ÏÔÊ¾ÆÁµÄÍ¬Ñ§£¬ÇëÓÃ¶Å°î°ÑP0.7Òı½Å½Óµ½GND£¬Ğ§¹ûÒ»Ñù¡£
  45          #include <at89x51.h>    
  46          #include <intrins.h>
  47          #include "LCD1602display.h"
  48          //#include "STC12C5A60S2_PWM.h"
  49          #define  TX  P2_1
  50          #define  RX  P2_0
  51          sbit DU = P2^6;
  52          sbit WE = P2^7;
  53          #define Forward_L_DATA  180//µ±Ç°½ø²»ÄÜ×ßÖ±ÏßµÄÊ±ºò£¬Çëµ÷½ÚÕâÁ½¸ö²ÎÊı£¬ÀíÏëµÄÊ±ºòÊÇ100,100£¬×î´ó256£¬×îĞ¡0
C51 COMPILER V9.01   MAIN                                                                  11/14/2013 12:05:30 PAGE 2   

             -¡£0µÄÊ±ºò×îÂı£¬256µÄÊ±ºò×î¿ì
  54          #define Forward_R_DATA  180     //ÀıÈçĞ¡³µÇ°½øµÄÊ±ºòÓĞµãÏò×ó¹Õ£¬ËµÃ÷ÓÒ±ßÂí´ï×ªËÙ¹ı¿ì£¬ÄÇ¿ÉÒÔÈ¡Ò»¸öÖµ´óÒ»µã£¬Áí
             -ÍâÒ»¸öÖµĞ¡Ò»µã£¬ÀıÈç 200  190
  55                                      //Ö±Á÷µç»úÒòÎªÖÆÔìÉÏµÄÎó²î£¬Í¬Ò»¸öÂö¿íÏÂÒ²²»Ò»¶¨ËÙ¶ÈÒ»ÖÂµÄ£¬ĞèÒª×Ô¼ºÊÖ¶¯µ÷½Ú
  56          
  57          //sbit P4_0=0xc0;       //P4¿ÚµØÖ·
  58          
  59          /*****°´ÕÕÔ­Í¼½ÓÏß¶¨Òå******/
  60          sbit L293D_IN1=P1^2; 
  61          sbit L293D_IN2=P1^3;
  62          sbit L293D_IN3=P1^6;
  63          sbit L293D_IN4=P1^7;
  64          sbit L293D_EN1=P1^4;
  65          sbit L293D_EN2=P1^5;
  66          
  67          sbit BUZZ=P2^3;
  68          
  69          void cmg88()//¹ØÊıÂë¹Ü£¬µãÕóº¯Êı
  70          {
  71   1      DU=1;  
  72   1      P0=0X00;
  73   1      DU=0;
  74   1      }
  75          
  76          void Delay400Ms(void);//ÑÓÊ±400ºÁÃëº¯Êı
  77          
  78          unsigned char code Range[] ="==Range Finder==";//LCD1602ÏÔÊ¾¸ñÊ½
  79          unsigned char code ASCII[13] = "0123456789.-M";
  80          unsigned char code table[]="Distance:000.0cm";
  81          unsigned char code table1[]="!!! Out of range";
  82          
  83          unsigned char disbuff[4]={0,0,0,0};//ÓÃÓÚ·Ö±ğ´æ·Å¾àÀëµÄÖµ0.1mm¡¢mm¡¢cmºÍmµÄÖµ
  84          
  85          void Count(void);//¾àÀë¼ÆËãº¯Êı
  86                                    
  87          unsigned int  time=0;//ÓÃÓÚ´æ·Å¶¨Ê±Æ÷Ê±¼äÖµ
  88          unsigned long S=0;//ÓÃÓÚ´æ·Å¾àÀëµÄÖµ
  89          bit  flag =0; //Á¿³ÌÒç³ö±êÖ¾Î»
  90          bit  turn_right_flag;
  91          
  92          //========================================================================================================
             -=================
  93          void Forward(unsigned char Speed_Right,unsigned char Speed_Left)//         Ç°½ø
  94          {
  95   1      
  96   1               L293D_IN1=0; 
  97   1               L293D_IN2=1;
  98   1               L293D_IN3=1;
  99   1               L293D_IN4=0;
 100   1      //     PWM_Set(255-Speed_Right,255-Speed_Left);
 101   1      }
*** WARNING C280 IN LINE 93 OF MAIN.C: 'Speed_Right': unreferenced local variable
*** WARNING C280 IN LINE 93 OF MAIN.C: 'Speed_Left': unreferenced local variable
 102          void Stop(void) //É²³µ
 103          {
 104   1      
 105   1           L293D_IN1=0; 
 106   1               L293D_IN2=0;
 107   1               L293D_IN3=0;
 108   1               L293D_IN4=0;
 109   1      //       PWM_Set(0,0);
 110   1      }
C51 COMPILER V9.01   MAIN                                                                  11/14/2013 12:05:30 PAGE 3   

 111          void Turn_Right(unsigned char Speed_Right,unsigned char Speed_Left)      //ºó
 112          {
 113   1          L293D_IN1=1; 
 114   1              L293D_IN2=0;
 115   1              L293D_IN3=0;
 116   1              L293D_IN4=0;
 117   1      //      PWM_Set(255-Speed_Right,255-Speed_Left);
 118   1      }
*** WARNING C280 IN LINE 111 OF MAIN.C: 'Speed_Right': unreferenced local variable
*** WARNING C280 IN LINE 111 OF MAIN.C: 'Speed_Left': unreferenced local variable
 119          //========================================================================================================
             -=================
 120          /********¾àÀë¼ÆËã³ÌĞò***************/
 121              void Conut(void)
 122                  {
 123   1               time=TH1*256+TL1;
 124   1               TH1=0;
 125   1               TL1=0;
 126   1              
 127   1               //´ËÊ±timeµÄÊ±¼äµ¥Î»¾ö¶¨ÓÚ¾§ÕñµÄËÙ¶È£¬Íâ½Ó¾§ÕñÎª11.0592MHZÊ±£¬
 128   1                          //timeµÄÖµÎª0.54us*time£¬µ¥Î»ÎªÎ¢Ãë
 129   1                                      //ÄÇÃ´1usÉù²¨ÄÜ×ß¶àÔ¶µÄ¾àÀëÄØ£¿1s=1000ms=1000000us 
 130   1                                      // 340/1000000=0.00034Ã×
 131   1                                      //0.00034Ã×/1000=0.34ºÁÃ×  Ò²¾ÍÊÇ1usÄÜ×ß0.34ºÁÃ×
 132   1                                      //µ«ÊÇ£¬ÎÒÃÇÏÖÔÚ¼ÆËãµÄÊÇ´Ó³¬Éù²¨·¢Éäµ½·´Éä½ÓÊÕµÄË«Â·³Ì£¬
 133   1                                      //ËùÒÔÎÒÃÇ½«¼ÆËãµÄ½á¹û³ıÒÔ2²ÅÊÇÊµ¼ÊµÄÂ·³Ì
 134   1      
 135   1              S=time*2;//ÏÈËã³öÒ»¹²µÄÊ±¼äÊÇ¶àÉÙÎ¢Ãë¡£
 136   1              S=S*0.17;//´ËÊ±¼ÆËãµ½µÄ½á¹ûÎªºÁÃ×£¬²¢ÇÒÊÇ¾«È·µ½ºÁÃ×µÄºóÁ½Î»ÁË£¬ÓĞÁ½¸öĞ¡Êıµã 
 137   1               if(S<=300)      //
 138   1               {      
 139   2                  if(turn_right_flag!=1)
 140   2                      {
 141   3                          Stop();
 142   3                          Delay1ms(5);//·¢ÏÖĞ¡³µ×Ô¶¯¸´Î»µÄÊ±ºò£¬¿ÉÒÔÉÔÎ¢ÑÓ³¤Ò»µãÕâ¸öÑÓÊ±£¬¼õÉÙµç»ú·´ÏòµçÑ¹¶ÔµçÂ·°åµÄ³å»÷¡£
 143   3                      }
 144   2                      turn_right_flag=1;
 145   2                      P2_3=0;
 146   2                      Delay1ms(50);
 147   2                      P2_3=1;
 148   2                  Turn_Right(120,120);                                //Ğ¡ÓÚÉè¶¨¾àÀëÊ±µç»úºóÍË×ªÍä
 149   2               }
 150   1               else
 151   1               {
 152   2                  turn_right_flag=0;
 153   2                  Forward(Forward_R_DATA,Forward_L_DATA);                       //Ç°½ø£¨´óÓÚ20-30CMÇ°½ø£©
 154   2               }
 155   1               //=======================================
 156   1               if((S>=5000)||flag==1) //³¬³ö²âÁ¿·¶Î§
 157   1               {      
 158   2                flag=0;
 159   2            DisplayListChar(0, 1, table1);
 160   2               }
 161   1               else
 162   1               {
 163   2            disbuff[0]=S%10;
 164   2                disbuff[1]=S/10%10;
 165   2                disbuff[2]=S/100%10;
 166   2                disbuff[3]=S/1000;
 167   2                DisplayListChar(0, 1, table);
 168   2                DisplayOneChar(9, 1, ASCII[disbuff[3]]);
 169   2                DisplayOneChar(10, 1, ASCII[disbuff[2]]);     
C51 COMPILER V9.01   MAIN                                                                  11/14/2013 12:05:30 PAGE 4   

 170   2                DisplayOneChar(11, 1, ASCII[disbuff[1]]);
 171   2            DisplayOneChar(12, 1, ASCII[10]);
 172   2                DisplayOneChar(13, 1, ASCII[disbuff[0]]);
 173   2               }
 174   1              }
 175          
 176          /********************************************************/
 177               void zd0() interrupt 3              //T0ÖĞ¶ÏÓÃÀ´¼ÆÊıÆ÷Òç³ö,³¬¹ı²â¾à·¶Î§
 178            {
 179   1          flag=1;                      //ÖĞ¶ÏÒç³ö±êÖ¾
 180   1              RX=0;
 181   1        }
 182          
 183          /********³¬Éù²¨¸ßµçÆ½Âö³å¿í¶È¼ÆËã³ÌĞò***************/
 184          void Timer_Count(void)
 185          {
 186   1                       TR1=1;                     //¿ªÆô¼ÆÊı
 187   1                   while(RX);                 //µ±RXÎª1¼ÆÊı²¢µÈ´ı
 188   1                   TR1=0;                             //¹Ø±Õ¼ÆÊı
 189   1               Conut();                       //¼ÆËã
 190   1      
 191   1      }
 192          /********************************************************/
 193             void  StartModule()                   //Æô¶¯Ä£¿é
 194            {
 195   1                TX=1;                                      //Æô¶¯Ò»´ÎÄ£¿é
 196   1            Delay10us(2);
 197   1                TX=0;
 198   1        }
 199          /********************************************************/ 
 200          
 201          /*************Ö÷³ÌĞò********************/
 202          void main(void)
 203          {
 204   1          unsigned char i;
 205   1              unsigned int a;
 206   1              cmg88();//¹ØÊıÂë¹Ü
 207   1              Delay1ms(400); //Æô¶¯µÈ´ı£¬µÈLCM½²Èë¹¤×÷×´Ì¬
 208   1              LCMInit(); //LCM³õÊ¼»¯
 209   1              Delay1ms(5);//ÑÓÊ±Æ¬¿Ì
 210   1      
 211   1              DisplayListChar(0, 0, Range);
 212   1              DisplayListChar(0, 1, table);
 213   1          TMOD=TMOD|0x10;//ÉèT0Îª·½Ê½1£¬GATE=1£»
 214   1          EA=1;                                          //¿ªÆô×ÜÖĞ¶Ï
 215   1          TH1=0;
 216   1          TL1=0;          
 217   1          ET1=1;             //ÔÊĞíT0ÖĞ¶Ï
 218   1      
 219   1              //===============================
 220   1              //PWM_ini();
 221   1              //===============================
 222   1              turn_right_flag=0;
 223   1              //=================================
 224   1      B:              for(i=0;i<50;i++) //ÅĞ¶ÏK3ÊÇ·ñ°´ÏÂ
 225   1                      {
 226   2                         Delay1ms(1); //1msÄÚÅĞ¶Ï50´Î£¬Èç¹ûÆäÖĞÓĞÒ»´Î±»ÅĞ¶Ïµ½K3Ã»°´ÏÂ£¬±ãÖØĞÂ¼ì²â
 227   2                         if(P3_6!=0 )//µ±K3°´ÏÂÊ±£¬Æô¶¯Ğ¡³µ
 228   2                         goto B; //Ìø×ªµ½±êºÅB£¬ÖØĞÂ¼ì²â
 229   2                      }
 230   1              //·äÃùÆ÷ÏìÒ»Éù
 231   1              BUZZ=0; //50´Î¼ì²âK3È·ÈÏÊÇ°´ÏÂÖ®ºó£¬·äÃùÆ÷·¢³ö¡°µÎ¡±ÉùÏì£¬È»ºóÆô¶¯Ğ¡³µ¡£
C51 COMPILER V9.01   MAIN                                                                  11/14/2013 12:05:30 PAGE 5   

 232   1              Delay1ms(50);
 233   1              BUZZ=1;//Ïì50msºó¹Ø±Õ·äÃùÆ÷
 234   1              //=======================================================================================================
             -================                      
 235   1              while(1)
 236   1                {
 237   2                      RX=1;
 238   2                  StartModule();                               //Æô¶¯Ä£¿é
 239   2              for(a=951;a>0;a--)
 240   2                  {
 241   3                         
 242   3                     if(RX==1)
 243   3                         {
 244   4                 Timer_Count();                //³¬Éù²¨¸ßµçÆ½Âö³å¿í¶È¼ÆËãº¯Êı
 245   4                         }
 246   3               }
 247   2              }
 248   1      } 
 249          
 250          
 251          
 252                          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    822    ----
   CONSTANT SIZE    =     64    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10      14
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  4 WARNING(S),  0 ERROR(S)
